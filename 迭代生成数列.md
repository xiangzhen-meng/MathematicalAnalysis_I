# 迭代生成数列

## 不动点

数列 $\{x_n\}$ 满足：$x_{n+1}=f(x_n)$ 
若有：
$$
\lim_{ n \to \infty }x_n=\xi,\ \lim_{ n \to \infty }f(x_n)=f(\xi)
$$
则极限 $\xi$ 一定是方程 $f(x)=x$ 的根，称其为函数 $f$ 的 **不动点** 

## 不动点的唯一性

### 例题 1 

>[!note] 例 1 
>![[IMG-20251011143411630.png]]

证明如下，设：
$$
f(f(x')) = x'
$$
下证存在性：
一方面，$f(\textcolor{blue}{f(f(x'))}) = f(x')$ （由设出的条件）
另一方面，$f(f(\textcolor{blue}{f(x')}))=f(x')$ ，所以 f(x') 也是不动点
又因为不动点是唯一的，所以 $f(x') = x'$ 

下证唯一性：
假设有另外一个不动点 x*，满足 f(x*) = x*
$$
f(f(x^*)) = f(x^*) = x^*
$$
由条件，f(f(x)) 的不动点是唯一的，所以 x* = x'，即不动点唯一

### 例题 2

>[!note] 例 2
>![[IMG-20251011143411652.png]]

证明：

假设集合 $S = \{x \in \mathbb{R} : f(f(x)) = x\}$ 恰为 $\{a, b\}$

取任意 $p \in \{a, b\}$，令 $q = f(p)$。考察 $f(f(q))$：
$$
f(f(q)) = f(f(f(p))) = f(p) = q,
$$

所以 $q$ 也是 $f \circ f$ 的不动点，即 $q \in S = \{a, b\}$。于是对 $p \in \{a, b\}$ 必有 $f(p) \in \{a, b\}$。换句话说，$f$ 将集合 $\{a, b\}$ 映到自身。

把把 $\{a, b\}$ 映到自身的情形列出来，有四种可能：

1. $f(a) = a$，$f(b) = b$（恒等映射）；
2. $f(a) = b$，$f(b) = a$（互换）；
3. $f(a) = a$，$f(b) = a$（常值为 $a$）；
4. $f(a) = b$，$f(b) = b$（常值为 $b$）。

我们只需排除第 3、4 种常值情形。若第 3 种成立，则

$$
f(f(b)) = f(a) = a,
$$

但 $b$ 是 $f \circ f$ 的不动点，应有 $f(f(b)) = b$，这与 $a \neq b$ 矛盾。第 4 种同理将导致 $f(f(a)) = b \neq a$，也矛盾。因此常值情形不可能。

因此仅剩第 1、第 2 两种情形：要么 $a, b$ 都是 $f$ 的不动点；要么 $f$ 在 $\{a, b\}$ 上互换，即 $f(a) = b$，$f(b) = a$。

## 压缩映射定理

### 概述

>[!note] 压缩映射定理
>$f(x)$ 定义在 $[a,b]$ 上，若：$$\forall x, y\in [a,b],|f(x)-f(y)|\leq k|x-y|,0<k<1$$则称 $f$ 是 $[a,b]$ 上的一个压缩映射

压缩映射有三条性质：

### 性质一：不动点存在性和唯一性

>[!note] 性质一
>$f$ 在 $[a,b]$ 存在唯一的不动点 $\xi$ 使得 $f(\xi)=\xi$，任何通过 $f$ 映射的序列必然收敛于 $\xi$

先证：$f(x_n)$ 收敛
$$
\begin{align}

\forall n>N, \forall p,|f(x_n)-f(x_{n+p})|&\leq k|x_{n}-x_{n+p}| \\
&=k|f(x_{n-1})-f(x_{n+p-1})| \\
&\leq\dots \\
&\leq k^n|x_{0}-x_p|
\end{align}
$$
RHS 是个无穷小量，显然能够取到 N，故是柯西列，故收敛

这时候对 $f(x_n)=x_{n-1}$ 取极限，得到不动点

下证：不动点唯一
反证法，若不然，则存在一个异于 $\xi$ 的 $\eta$ 同为不动点，则必有：
$$
|f(\xi)-f(\eta)|=|\xi-\eta|\leq k|\xi-\eta|
$$
由于 $k>0$ 故矛盾，故不动点唯一

### 性质二：给出估计式

>[!note] 估计式
>成立估计式$$|a_n- \xi|\leq \frac{k}{1-k}|a_n-a_{n-1}|$$以及$$|a_n-\xi|\leq \frac{k^n}{1-k}|a_{1}-a_{0}|$$

对于第一个式子：
$$
|a_n-\xi|=|f(a_{n-1})-f(\xi)|\leq k|a_{n-1}-\xi|\leq k|a_n-a_{n-1}|+k|a_n-\xi|
$$
则第一个式子成立

对第一个式子逐项使用 
$$
|a_n-a_{n-1}|\leq k|a_{n-1}-a_{n-2}|
$$
即可证明第二个式子

## 布劳威尔不动点定理

>[!note] 布劳威尔不动点定理的特例
>函数 $f(x)\in C[a,b]$，且有：$f([a,b])\subset[a,b]$，求证：$$\exists \xi\in [a,b],s.t.f(\xi)=\xi$$

引入辅助函数：$F(x)=f(x)-x$

显然有：
$$
F(a)=f(a)-a\geq 0,F(b)=f(b)-b\leq 0
$$
故由 [[介值定理]] ，显然存在零点，也即存在不动点

## 例题

### 例题 1 奇偶项分别单调的序列

>[!note] 例题 1 
>$\{b_n\}$ 满足：$$
>b_{1}=1,\ b_{n+1}=1+ \frac{1}{b_n}
>$$讨论其敛散性，若收敛则求出其极限

#### 分析

首先算出其中前若干项，发现：
$$
b_{1}<b_{3}<b_{5}<\dots<b<\dots<b_{6}<b_{4}<b_{2}
$$
猜测：奇数项单调递增有上界，偶数项单调递减有下界

写出不动点方程：
$$
b=1+ \frac{1}{b}
$$
解得：
$$
b=\frac{1+\sqrt{ 5 }}{2}
$$
#### 证明

**首先说明奇偶项分列在 b 的两侧**
首项：$b_{1}=1,b_{2}=2$，其实只要说明：$b_n-b$ 与 $b_{n+2}-b$ 同号即可
首先可以推出：
$$
b_{n+2}=2- \frac{1}{b_n+1}
$$
同时，由于 b 的性质，可以写出同样结构的式子：
$$
b=2-\frac{1}{b+1}
$$
两个式子对应相减，得到：
$$
b_{n+2}-b=\frac{1}{b+1}-\frac{1}{b_n+1}=\frac{b_n-b}{(b_n+1)(b+1)}
$$
显然同号

这也说明了奇偶项分别是有上界和下界的

**然后说明奇偶项分别的单调性**
仿照上面的证明，将两个隔两项的递推公式相减，得到：
$$
b_{n+2}-b_n=\frac{1}{b_{n-2}+1}-\frac{1}{b_n+1}=\frac{b_n-b_{n-2}}{(b_n+1)(b_{n-2}+1)}
$$
显然有：$b_{n+2}-b_n$ 与 $b_n-b_{n-2}$ 同号

由上述两个证明，分别可知：奇数项单调递增有上界则有极限，偶数项单调递减有下界则有极限。在他们共同的递推公式：
$$
b_{n+2}=2- \frac{1}{b_n+1}
$$
令 $n\to +\infty$ ，得到他们的极限都是 b，因此原数列收敛于 b

#### 另外的做法

使用压缩映射定理：

注意到：
$$
\frac{3}{2}=b_{3}<b_n<b_{2}=2
$$
注：这的确是容易注意到的，画出蛛网图即可

而显然有函数为递推关系：
$$
f(x)=1+\frac{1}{x}
$$
故 $\forall x, y\in\{b_n\}, n\geq 3$ 有：
$$
|f(x)-f(y)|=\frac{|x-y|}{|xy|}\leq \frac{1}{1.5^2}|x-y|
$$
故为压缩映射，故收敛于不动点

### 例题 2 求倒数的极限方法

>[!note] 例题 2
>给定 $c>0$，任取 $0<x_{0}< \frac{1}{c}$，并定义序列$$x_{n+1}=x_n(2-cx_n)$$求 $\lim_{ n \to \infty }x_n$

#### 分析

本题显然是需要先证明极限存在，然后直接取极限算不动点
重点是如何判定极限存在

#### 证明一：单调收敛原理

考察 **有界性**：
可以对其配方，得到：
$$
\begin{align}
x_{n+1}&=-cx_n^2+2x_n \\
&=-c\left( x_n^2- \frac{2}{c}x_n+\frac{1}{c^2} \right)+\frac{1}{c} \\
&=-c\left( x_n-\frac{1}{c} \right)^2+ \frac{1}{c}
\end{align}
$$
由二次函数的性质，可以知道：
$$
0<x_n< \frac{1}{c}
$$
考察 **单调性**：
$$
\frac{x_{n+1}}{x_n}=-cx_n+2
$$
而由题目条件有：
$$
0<1<-cx_n+2<2
$$
则单调递增

单调递增有上界，则说明极限存在，对两边取极限，得到：
$$
\lim_{ n \to \infty } x_n= \frac{1}{c}
$$

### 例题 3 对阶乘和比值的估计

>[!note] 例题 3 
>给定序列 $\{a_n\}$ 满足：$$a_n=\frac{1!+2!+\dots+n!}{n!},n\in N_+$$求序列极限

本题做法一，参看 [[对阶乘的估计#例子 2 全部放缩成一样的，但是留下主项]] 

这里给出本题的另一种做法，也即总结递推公式，然后根据单调收敛准则证明极限存在，进而两边同时取极限再解方程求出极限

首先观察递推公式
$$a_n=\frac{1!+2!+\dots+n!}{n!}$$
下一项写出来：
$$
\begin{align}
a_{n+1}&=\frac{1!+2!+\dots+n!+(n+1)!}{(n+1)!} \\
&=\frac{1!+2!+\dots+n!}{(n+1)!}+1 \\
&=\frac{1}{n+1}a_n+1=1+\frac{a_n}{n+1}
\end{align}
$$
之后通过巧妙的观察，发现序列从第三项开始单调递减，且有下界 1，故收敛

对两边同时取极限，得到极限为 1
